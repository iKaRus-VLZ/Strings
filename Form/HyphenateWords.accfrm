Version =20
VersionRequired =20
Checksum =-2025337675
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    RecordLocks =2
    TabularCharSet =204
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =6950
    DatasheetFontHeight =10
    ItemSuffix =18
    Left =780
    Top =1245
    Right =7455
    Bottom =5805
    DatasheetGridlinesColor =12632256
    Tag ="BackColor=Light"
    RecSrcDt = Begin
        0x846aaba14d51e540
    End
    GUID = Begin
        0xef75538071641d4bbb01ac814f1ef643
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000005000000 ,
        0x0000000000000000000000000000
    End
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x3702000037020000370200003702000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x00000000000000009091ed070000000020569b29f77f0000335c3c29f77f0000 ,
        0x0104220b9c006c01036e07000100090000000000640001000100580202000100 ,
        0x5802030000004134002ab20000000000feffffffffffffff25ddb229f97f0000 ,
        0xc0c0c00000005802180000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000046500800 ,
        0x4d53414343455353000000000000000000000000000000000000000000000000 ,
        0xff3e03005802aa00ac00aa00ac00010000003100436f7572696572204e657700 ,
        0x0000000000000000000000000000000000000000010001000200000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000009600 ,
        0x4b002c0100800000
    End
    PrtDevNames = Begin
        0x080015001f000100000000000000000000000000000000000000000000000046 ,
        0x505231313a00
    End
    OnResize ="[Event Procedure]"
    AllowDatasheetView =0
    UnknownProp = {305 ,452 ,1 ,1 ,1 } Begin
        0x00
    End
    UnknownProp = {400 ,582 ,4 ,4 ,4 } Begin
        0xc0c0c000
    End
    UnknownProp = {419 ,678 ,11 ,0 ,584 } Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0104220bdc006c01036e07000100090000000000640001000100580202000100 ,
        0x5802030000004100340000000000000009031000000000000000000000000000 ,
        0x5002000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000005802180000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000046500800 ,
        0x4d53414343455353000000000000000000000000000000000000000000000000 ,
        0xff3e03005802aa00ac00aa00ac00010000003100436f7572696572204e657700 ,
        0x0000000000000000000000000000000000000000010001000200000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000009600 ,
        0x4b002c0100800000
    End
    UnknownProp = {420 ,679 ,11 ,0 ,68 } Begin
        0x040011001b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000046005000520031003100 ,
        0x3a000000
    End
    Begin
        Begin Label
            BackStyle =0
            TextFontCharSet =204
            FontName ="Tahoma"
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin CommandButton
            TextFontCharSet =204
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            UnknownProp = {324 ,11 ,2 ,1 ,1 } Begin
                0x00
            End
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            TextFontCharSet =204
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin FormHeader
            Height =567
            BackColor =-2147483633
            Name ="ЗаголовокФормы"
            Tag ="BackColor=Dark"
            GUID = Begin
                0xc609bedada7e574ab34ed73e90aafdd3
            End
            Begin
                Begin Label
                    OverlapFlags =93
                    Left =103
                    Top =103
                    Width =6665
                    Height =454
                    FontSize =14
                    FontWeight =700
                    ForeColor =9605778
                    Name ="lblTitle2"
                    Caption ="Заголовок"
                    Tag ="FontColor=Grey"
                    GUID = Begin
                        0xa81e5bda2f4db1409ee1e053e928311b
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x67000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0x67000000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x701a0000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0x2d020000
                    End
                End
                Begin Label
                    OverlapFlags =223
                    Left =60
                    Top =60
                    Width =6665
                    Height =454
                    FontSize =14
                    FontWeight =700
                    Name ="lblTitle"
                    Caption ="Заголовок"
                    Tag ="FontColor=White"
                    GUID = Begin
                        0x95fa43a0e1e0bf49a74f951feb52f9c8
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x451a0000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0x02020000
                    End
                    UnknownProp = {298 ,622 ,4 ,0 ,4 } Begin
                        0x00000000
                    End
                End
                Begin Line
                    OverlapFlags =87
                    SpecialEffect =5
                    Left =70
                    Top =510
                    Width =6805
                    Name ="Line01"
                    GUID = Begin
                        0x1d9355c2711b1340a2cee6200d69f2cd
                    End
                    UnknownProp = {276 ,586 ,3 ,4 ,4 } Begin
                        0x46000000
                    End
                    UnknownProp = {277 ,587 ,3 ,4 ,4 } Begin
                        0xfe010000
                    End
                    UnknownProp = {278 ,588 ,3 ,4 ,4 } Begin
                        0xdb1a0000
                    End
                    UnknownProp = {279 ,589 ,3 ,4 ,4 } Begin
                        0xfe010000
                    End
                End
            End
        End
        Begin Section
            Height =3118
            BackColor =-2147483633
            Name ="ОбластьДанных"
            GUID = Begin
                0xb951e0fd78f77e41b074e842b03f2d4e
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =0
                    OverlapFlags =85
                    TextAlign =3
                    BackStyle =0
                    IMESentenceMode =3
                    Left =56
                    Top =2440
                    Width =733
                    TabIndex =4
                    Name ="txtWidthTw"
                    Format ="General Number"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0x6540c780c92e194f843ccec8ad6c6b7c
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0x38000000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0x88090000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x15030000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0x780a0000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =855
                            Top =2440
                            Width =255
                            Height =240
                            Name ="Надпись5"
                            Caption ="tw"
                            GUID = Begin
                                0x9f0ee98fe5074946aad95acc37a8771d
                            End
                            UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                                0x57030000
                            End
                            UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                                0x88090000
                            End
                            UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                                0x56040000
                            End
                            UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                                0x780a0000
                            End
                        End
                    End
                End
                Begin TextBox
                    DecimalPlaces =0
                    OverlapFlags =85
                    TextAlign =3
                    IMESentenceMode =3
                    Left =64
                    Top =2144
                    Width =733
                    TabIndex =3
                    Name ="txtWidthPx"
                    Format ="General Number"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xa48910fc0a765145b194698940965e0d
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0x40000000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0x60080000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x1d030000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0x50090000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =863
                            Top =2144
                            Width =255
                            Height =240
                            Name ="Надпись8"
                            Caption ="px"
                            GUID = Begin
                                0xfd7d47c55b6656468488efe3d2c8104e
                            End
                            UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                                0x5f030000
                            End
                            UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                                0x60080000
                            End
                            UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                                0x5e040000
                            End
                            UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                                0x50090000
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =60
                    Top =960
                    Width =1080
                    Height =240
                    Name ="Надпись4"
                    Caption ="Ширина"
                    GUID = Begin
                        0x46d8c1f4e54ec84bb69d87bb853cb6ab
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0xc0030000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x74040000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0xb0040000
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =2
                    OverlapFlags =85
                    TextAlign =3
                    BackStyle =0
                    IMESentenceMode =3
                    Left =60
                    Top =2736
                    Width =733
                    TabIndex =5
                    Name ="txtWidthCm"
                    Format ="Standard"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xeb2a11e513303e43870d5435b31edba9
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0xb00a0000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x19030000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0xa00b0000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =855
                            Top =2736
                            Width =270
                            Height =240
                            Name ="Надпись10"
                            Caption ="cm"
                            GUID = Begin
                                0xb30e36f2ac13e546973f9ebe8cfa9e4e
                            End
                            UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                                0x57030000
                            End
                            UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                                0xb00a0000
                            End
                            UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                                0x65040000
                            End
                            UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                                0xa00b0000
                            End
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =0
                    OverlapFlags =85
                    TextAlign =3
                    BackStyle =0
                    IMESentenceMode =3
                    Left =56
                    Top =1552
                    Width =733
                    TabIndex =2
                    Name ="txtTextPx"
                    Format ="General Number"
                    GUID = Begin
                        0x85f79ab7f3789e4e9a22c3db0cf6e4cb
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0x38000000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0x10060000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x15030000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0x00070000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =855
                            Top =1552
                            Width =255
                            Height =240
                            Name ="Надпись12"
                            Caption ="px"
                            GUID = Begin
                                0x6992731b662dd345aaf9004b24f3ea32
                            End
                            UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                                0x57030000
                            End
                            UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                                0x10060000
                            End
                            UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                                0x56040000
                            End
                            UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                                0x00070000
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Top =1256
                    Width =1080
                    Height =240
                    Name ="Надпись13"
                    Caption ="Текста:"
                    GUID = Begin
                        0x0a0e149b9674414986859dd82108d3b7
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x38000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0xe8040000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x70040000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0xd8050000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Top =1848
                    Width =1080
                    Height =240
                    Name ="Надпись14"
                    Caption ="Области:"
                    GUID = Begin
                        0x23660b17496d3f4eb00376345bf1b77f
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x38000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0x38070000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x70040000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0x28080000
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1222
                    Top =960
                    Width =5536
                    Height =2077
                    ColumnOrder =0
                    TabIndex =1
                    Name ="txtInput"
                    OnChange ="[Event Procedure]"
                    GUID = Begin
                        0xc1680d8f64a9f243b5a345fea7860d2a
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0xc6040000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0xc0030000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x661a0000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0xdd0b0000
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    IMESentenceMode =3
                    Left =1222
                    Top =60
                    Width =5536
                    Height =770
                    Name ="txtSample"
                    GUID = Begin
                        0x09763a7f315e1f44ab6759c2844b6cb9
                    End
                    UnknownProp = {299 ,0 ,3 ,4 ,4 } Begin
                        0xffffffff
                    End
                    UnknownProp = {302 ,586 ,3 ,4 ,4 } Begin
                        0xc6040000
                    End
                    UnknownProp = {303 ,587 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {304 ,588 ,3 ,4 ,4 } Begin
                        0x661a0000
                    End
                    UnknownProp = {305 ,589 ,3 ,4 ,4 } Begin
                        0x3e030000
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =60
                            Top =60
                            Width =915
                            Height =240
                            FontWeight =700
                            Name ="Надпись18"
                            Caption ="Текст:"
                            GUID = Begin
                                0x7a4887285db79c4788b072b28e39de29
                            End
                            UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                                0x3c000000
                            End
                            UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                                0x3c000000
                            End
                            UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                                0xcf030000
                            End
                            UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                                0x2c010000
                            End
                        End
                    End
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Left =60
                    Top =890
                    Width =6692
                    Name ="Line02"
                    GUID = Begin
                        0xd352e397be93474080fc20f6fff05ce4
                    End
                    UnknownProp = {276 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {277 ,587 ,3 ,4 ,4 } Begin
                        0x7a030000
                    End
                    UnknownProp = {278 ,588 ,3 ,4 ,4 } Begin
                        0x601a0000
                    End
                    UnknownProp = {279 ,589 ,3 ,4 ,4 } Begin
                        0x7a030000
                    End
                End
            End
        End
        Begin FormFooter
            Height =1134
            BackColor =-2147483633
            Name ="ПримечаниеФормы"
            GUID = Begin
                0x12092e7d9d47e845a5d05d2b5bb97aff
            End
            Begin
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =5
                    Left =70
                    Width =6805
                    Name ="Line03"
                    GUID = Begin
                        0x3ee0ec6de24c6c4e9efdba3649ba6795
                    End
                    UnknownProp = {276 ,586 ,3 ,4 ,4 } Begin
                        0x46000000
                    End
                    UnknownProp = {278 ,588 ,3 ,4 ,4 } Begin
                        0xdb1a0000
                    End
                End
                Begin Label
                    OverlapFlags =93
                    Left =60
                    Top =31
                    Width =6665
                    Height =825
                    Name ="lblComment"
                    Caption ="Комментарий"
                    GUID = Begin
                        0x685af9de51aeac4586ab28cbb6484a7f
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0x1f000000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x451a0000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0x58030000
                    End
                End
                Begin Label
                    OverlapFlags =87
                    Left =60
                    Top =856
                    Width =6665
                    Height =240
                    ForeColor =16711680
                    Name ="lblLink"
                    Caption ="Link:"
                    GUID = Begin
                        0x47bfdb17e5eb284ebcd8aafba09fd503
                    End
                    UnknownProp = {282 ,586 ,3 ,4 ,4 } Begin
                        0x3c000000
                    End
                    UnknownProp = {283 ,587 ,3 ,4 ,4 } Begin
                        0x58030000
                    End
                    UnknownProp = {284 ,588 ,3 ,4 ,4 } Begin
                        0x451a0000
                    End
                    UnknownProp = {285 ,589 ,3 ,4 ,4 } Begin
                        0x48040000
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Private Const c_strTitle = "Расстановка переносов"
Private Const c_strComment = "Пример демонстрирует расстановку переносов в тексте." & vbCrLf & _
                             "Чтобы посмотреть на это в динамике - подвигайте границы формы." & vbCrLf & _
                             "Для расстановки переносов используется функция HyphenateWord." & vbCrLf & _
                             "Оригинал функции взят отсюда:"
Private Const c_strLink = "http://www.cyberforum.ru/vba/thread792944.html"
Private Const Indent = 70 '0.125 * cm   ' отступ от края формы и расстояние между контролами
Private Const c_strTestString = "Таким хитроумным способом Винда демонстрирует юзеру, каким образом выглядят буквы в кириллических шрифтах для пользователей перевода Windows для России."
Private mstrHyphenatedText As String
Private hdc As LongPtr, hFont As LongPtr
Private Const Offset = 4 '6 ' << (опытным путём) разница в px между шириной контрола и шириной области ввода
'--------------------------------------------------------------------------------
' USER32
'--------------------------------------------------------------------------------
#If VBA7 And Win64 Then '<WIN64 & OFFICE2010+>
Private Declare PtrSafe Function GetDC Lib "user32.dll" (ByVal hwnd As LongPtr) As LongPtr
Private Declare PtrSafe Function ReleaseDC Lib "user32.dll" (ByVal hwnd As LongPtr, ByVal hdc As LongPtr) As Long
#Else                   '<WIN32>
Private Declare Function GetDC Lib "user32.dll" (ByVal hwnd As Long) As Long
Private Declare Function ReleaseDC Lib "user32.dll" (ByVal hwnd As Long, ByVal hdc As Long) As Long
#End If                 '<WIN32>
'--------------------------------------------------------------------------------
' GDI32
'--------------------------------------------------------------------------------
#If VBA7 And Win64 Then '<WIN64 & OFFICE2010+>
Private Declare PtrSafe Function DeleteObject Lib "gdi32" (ByVal hObject As LongPtr) As Long
#Else                   '<WIN32>
Private Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As Long
#End If                 '<WIN32>
'--------------------------------------------------------------------------------
Private Sub Form_Open(Cancel As Integer):
Const cShadow = 0.075 * cm
    lblTitle.Caption = c_strTitle: lblTitle2.Caption = lblTitle.Caption: lblTitle2.Left = lblTitle.Left + cShadow: lblTitle2.Top = lblTitle.Top + cShadow
    lblComment.Caption = c_strComment
    lblLink.Caption = c_strLink: lblLink.HyperlinkAddress = c_strLink
    InsideHeight = Section(acDetail).Height + Section(acHeader).Height + Section(acFooter).Height
' начальные значения
    txtSample.Value = c_strTestString: mstrHyphenatedText = HyphenateWord(c_strTestString)
    hdc = GetDC(0)
    hFont = CreateHFontByControl(txtInput, hdc:=hdc)
    Form_Resize
End Sub
Private Sub Form_Resize()
' обрабатываем изменение границ
    On Error Resume Next 'GoTo HandleError
Dim tmpWidth As Long:   tmpWidth = Me.InsideWidth '- ConvPixelsToTwips(rct.Right - rct.Left)
Dim tmpHeight As Long:  tmpHeight = InsideHeight - Section(acHeader).Height - Section(acFooter).Height
Dim i As Long
    For i = 1 To 9
        With Controls("Line" & Format$(i, "00"))
            If Err Then Err.Clear Else .Left = Indent: .Width = tmpWidth - 2 * Indent
        End With
    Next i
' ресайзим дополнительные контролы по форме
    With lblTitle:      .Width = tmpWidth - 4 * Indent: End With
    With lblTitle2:     .Width = tmpWidth - 4 * Indent: End With
    With lblComment:    .Width = tmpWidth - 4 * Indent: End With
    With lblLink:       .Width = tmpWidth - 4 * Indent: End With
    
    On Error GoTo HandleError
    With txtSample
        .Width = InsideWidth - 2 * cm - 2 * Indent
        .Left = Indent + 2 * cm:
        '.Top = Indent
        '.Height =
    End With
    With txtInput
        .Width = InsideWidth - 2 * cm - 2 * Indent
        .Left = Indent + 2 * cm:
        '.Top = txtSample.Top + txtSample.Height + 2 * Indent
        .Height = tmpHeight - .Top - Indent
    End With
' собственно разбиение на строки и вывод
    p_UpdateText
HandleExit:  Exit Sub
HandleError: Err.Clear: Resume HandleExit
    Select Case Err.Number
    Case 2100 ' Элемент не может быть размещен в указанном месте
'        Section(acDetail).Height = Section(acDetail).Height + 2 * Indent
    Case Else: Stop
    End Select
    Err.Clear: Resume HandleExit
End Sub
Private Sub Form_Close()
    DeleteObject hFont
    ReleaseDC 0, hdc
End Sub
Private Sub txtInput_Change(): mstrHyphenatedText = HyphenateWord(txtInput.Text): p_UpdateText: End Sub
Private Sub txtWidthCm_AfterUpdate()
Dim Wc As Long:  Wc = txtWidthCm * cm
    InsideWidth = Wc + 2 * cm + 2 * Indent
    'Form_Resize
End Sub
Private Sub txtWidthTw_AfterUpdate()
Dim Wc As Long: Wc = txtWidthTw
    InsideWidth = Wc + 2 * cm + 2 * Indent
    'Form_Resize
End Sub
Private Sub txtWidthPx_AfterUpdate()
Dim Wc As Long: Wc = PixelsToTwips(txtWidthPx + Offset, DIRECTION_HORIZONTAL)
    InsideWidth = Wc + 2 * cm + 2 * Indent
    'Form_Resize
End Sub
Private Function p_UpdateText()
' собственно разбиение на строки и вывод
    With txtInput
        'Call AccControlLocation(txtInput, , , Wc)
Dim Wc As Long: Wc = TwipsToPixels(.Width, DIRECTION_HORIZONTAL) - Offset
        txtWidthCm.Value = .Width / cm
        txtWidthTw.Value = .Width
        txtWidthPx.Value = Wc
        .Value = TextToArrayByWidth(mstrHyphenatedText, Wc, hFont:=hFont, hdc:=hdc)
'        Call TextToArrayByControl(mstrHyphenatedText, txtSample, Wc)
    End With
    txtTextPx.Value = Wc ' возвращаем реальную ширину текста
End Function